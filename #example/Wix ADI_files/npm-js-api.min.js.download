!function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=6)}([function(a,b,c){function d(a){if(a)return e(a)}function e(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}a.exports=d,d.prototype.on=d.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(b),this},d.prototype.once=function(a,b){function c(){this.off(a,c),b.apply(this,arguments)}return c.fn=b,this.on(a,c),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks["$"+a];if(!c)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var d,e=0;e<c.length;e++)if((d=c[e])===b||d.fn===b){c.splice(e,1);break}return this},d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks["$"+a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]},d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d;!function(a){a[a.CLOSED=0]="CLOSED",a[a.OPENING=1]="OPENING",a[a.OPEN=2]="OPEN"}(d||(d={})),b.default=d},function(a,b,c){"use strict";function d(a,b,c){return a.on(b,c),{destroy:function(){return a.off(b,c)}}}Object.defineProperty(b,"__esModule",{value:!0}),b.default=d},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=function(a){function b(b){var c=a.call(this)||this;return c.name=b,c}return d(b,a),b.prototype.subscribe=function(){this.doSubscribe()},b.prototype.unsubscribe=function(){this.doUnsubscribe()},b}(e);b.default=f},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(13),g=function(a){function b(b){var c=a.call(this)||this;return c.channels=new f.default(c,b),c}return d(b,a),b.prototype.subscribe=function(a){var b=this.channels.add(a);return b.subscribe(),b},b.prototype.unsubscribe=function(a){var b=this.channels.remove(a);return b.unsubscribe(),b},b}(e);b.default=g},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.wsClient="ws.manager",b.wsVs="ws.vs"},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.assign(window,{core:window.core||{},ob:window.ob||{}}),c(7)},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(8),e=c(28),f=window;Object.assign(f,{ob:f.ob||{},jsonpatch:f.jsonpatch||e,Duplexer:f.Duplexer||d.Duplexer}),c(29),c(30),c(31),c(32),c(33),c(34),c(35),c(36),c(37),c(38),c(39),c(40),c(41),c(42),c(43),c(44),c(45),c(46),c(47),c(48),c(49),c(50),c(51),c(52)},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(9);b.Duplexer=d.default;var e=c(24);b.DuplexerFrame=e.default;var f=c(27);b.DuplexerFrameListener=f.default},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(10),g=c(14),h=c(20),i=function(a){function b(b,c){var d=void 0===c?{}:c,e=d.pingInterval,f=void 0===e?3e4:e,i=d.pingTimeout,j=void 0===i?5e3:i,k=d.environment,l=a.call(this)||this;return l.virtualSockets=[],l.environment=k||new g.default(b),l.connection=new h.default({pingTimeout:j,pingInterval:f,environment:l.environment}),l.listen(),l}return d(b,a),b.prototype.connect=function(a){var b=new f.default(this,a);return this.virtualSockets.push(b),b},b.prototype.close=function(){this.connection.close()},b.prototype.closeVirtualSocket=function(a){this.virtualSockets=this.virtualSockets.filter(function(b){return b!==a}),0===this.virtualSockets.length&&this.close()},b.prototype.packet=function(a){var b=JSON.stringify(a);this.connection.send(b)},b.prototype.listen=function(){var a=this;this.connection.on("open",function(){return a.emit("open")}),this.connection.on("message",function(b){return a.emit("packet",b)}),this.connection.on("close",this.onClose.bind(this))},b.prototype.onClose=function(a){this.emit("close",a),a&&this.emitAll("@duplexer:connection-error",a)},b.prototype.emitAll=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];this.virtualSockets.forEach(function(c){return c.emit.apply(c,[a].concat(b))})},b}(e);b.default=i},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(1),f=c(11),g=c(2),h=c(4),i=function(a){function b(b,c){var d=a.call(this,f.default)||this;return d.duplexer=b,d.sessionId="",d.ids=1,d.connected=!1,d.sendBuffer=[],d.receiveBuffer=[],d.acks={},d.socketListeners=[],d.ns=c.apiKey,d.config={auth:c.auth},d.open(),d}return d(b,a),b.prototype.open=function(){var a=this.duplexer.connection.readyState;this.listen(),a===e.default.CLOSED?this.duplexer.connection.connect():a===e.default.OPEN&&this.connect()},b.prototype.disconnect=function(){this.send({type:"disconnect"}),this.cleanup(),this.duplexer.closeVirtualSocket(this),this.onClose()},b.prototype.send=function(a,b){var c=this;return void 0===b&&(b={force:!1}),new Promise(function(d){if(c.connected||b.force){var e=c.issueAckId();c.acks[e]=d,a.id=e,c.packet(a)}else c.sendBuffer.push({message:a,resolve:d})})},b.prototype.listen=function(){this.socketListeners=[g.default(this.duplexer,"open",this.connect.bind(this)),g.default(this.duplexer,"packet",this.onPacket.bind(this)),g.default(this.duplexer,"close",this.onClose.bind(this))]},b.prototype.onClose=function(a){this.connected=!1,this.emit("@duplexer:disconnected",a)},b.prototype.onPacket=function(a){if(a.ns===this.ns)switch(a.type){case"ack":this.onAck(a);break;case"message":this.onMessage(a)}},b.prototype.onConnect=function(a){this.sessionId=a.sessionId,this.channels.subscribeAll(),this.connected=!0,this.emit("@duplexer:connected"),this.emitBuffered()},b.prototype.onMessage=function(a){var b=this.channels.find(a.channel);void 0!==b&&(b.lastMessageId(a.id),b.emit(a.event,a.payload))},b.prototype.onAck=function(a){var b=this.acks[a.id];"function"==typeof b&&(b(a),delete this.acks[a.id])},b.prototype.connect=function(){var a=this,b={type:"connect",apiKey:this.ns,sessionId:this.sessionId};return this.send(b,{force:!0}).then(function(b){return a.onConnect(b)})},b.prototype.packet=function(a){a.ns=this.ns,this.duplexer.packet(a)},b.prototype.emitBuffered=function(){var a=this;this.receiveBuffer.forEach(function(b){return a.onPacket(b)}),this.receiveBuffer=[],this.sendBuffer.forEach(function(b){var c=b.message,d=b.resolve;a.send(c).then(d)}),this.sendBuffer=[]},b.prototype.issueAckId=function(){return(this.ids++).toString()},b.prototype.cleanup=function(){this.socketListeners.forEach(function(a){return a.destroy()})},b}(h.default);b.default=i},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(3),f=c(12),g=function(a){function b(b,c){var d=a.call(this,c)||this;return d.io=b,d._lastMessageId="",d.subscribing=!1,d.authenticator=new f.default(d.io.config.auth),d}return d(b,a),b.prototype.lastMessageId=function(a){return void 0!==a&&(this._lastMessageId=a),this._lastMessageId},b.prototype.doSubscribe=function(){var a=this;if(!this.subscribing){var b=this.isAuthRequired()?this.auth():Promise.resolve(""),c=this.buildRestoreStrategy();this.subscribing=!0,b.then(function(b){return a.io.send({type:"subscribe",channel:a.name,auth:b,restore:c})}).then(function(b){a.subscribing=!1,a.emit("@duplexer:subscription-succeeded",{isSynced:b.isSynced})}).catch(function(){return a.subscribing=!1})}},b.prototype.doUnsubscribe=function(){var a=this;this.io.send({type:"unsubscribe",channel:this.name}).then(function(){return a.emit("unsubscribe")})},b.prototype.auth=function(){return this.authenticator.auth(this.name)},b.prototype.isAuthRequired=function(){return 0===this.name.indexOf("@private")||0===this.name.indexOf("@presence")},b.prototype.buildRestoreStrategy=function(){return this._lastMessageId?{strategy:"message_id",id:this._lastMessageId}:void 0},b}(e.default);b.default=g},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a){this.opts=a,this.xhrClient=new e}return a.prototype.auth=function(a){var b=this.opts.interceptor?this.opts.interceptor():{},c={channelName:a,custom:b.body};return this.xhrClient.post(this.opts.url,c)},a}();b.default=d;var e=function(){function a(){}return a.prototype.post=function(a,b){return new Promise(function(c,d){var e=new XMLHttpRequest;e.open("POST",a),e.setRequestHeader("Content-Type","application/json"),e.onload=function(){200===e.status&&c(e.response)};var f=JSON.stringify(b);e.send(f)})},a}()},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){this.virtualSocket=a,this.ChannelType=b,this.channelsList={}}return a.prototype.add=function(a){return this.channelsList[a]=this.channelsList[a]||new this.ChannelType(this.virtualSocket,a)},a.prototype.remove=function(a){var b=this.find(a);return delete this.channelsList[a],b},a.prototype.find=function(a){return this.channelsList[a]},a.prototype.all=function(){var a=this;return Object.keys(this.channelsList).map(function(b){return a.find(b)})},a.prototype.subscribeAll=function(){var a=this;Object.keys(this.channelsList).forEach(function(b){return a.channelsList[b].subscribe()})},a}();b.default=d},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(15),e=c(17),f=function(){function a(a){this._network=new d.default,this._ws=new e.default(a)}return Object.defineProperty(a.prototype,"network",{get:function(){return this._network},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"transports",{get:function(){return[this._ws]},enumerable:!0,configurable:!0}),a}();b.default=f},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(16),f=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return d(b,a),Object.defineProperty(b.prototype,"isOnline",{get:function(){return"undefined"==typeof window||(void 0===window.navigator.onLine||window.navigator.onLine)},enumerable:!0,configurable:!0}),b.prototype.listenConnectionStateChanges=function(){var a=this;"undefined"!=typeof window&&(window.addEventListener("online",function(){return a.connectionIsOnline()}),window.addEventListener("offline",function(){return a.connectionIsOffline()}))},b}(e.default);b.default=f},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=function(a){function b(){var b=a.call(this)||this;return b.listenConnectionStateChanges(),b}return d(b,a),b.prototype.connectionIsOnline=function(){this.emit("online")},b.prototype.connectionIsOffline=function(){this.emit("offline")},b}(e);b.default=f},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(18),f=c(19),g=function(a){function b(b){var c=a.call(this)||this;return c.url=b,c}return d(b,a),b.prototype.doOpen=function(){this.ws=new WebSocket(this.url),this.listen()},b.prototype.doClose=function(){this.ws.close()},b.prototype.write=function(a){this.ws.send(a)},b.prototype.listen=function(){var a=this;this.ws.onopen=function(){a.onOpen()},this.ws.onclose=function(b){var c=b.wasClean?void 0:new f.default(b.code,b.reason);a.onClose(c)},this.ws.onmessage=function(b){a.onData(b.data)},this.ws.onerror=function(b){a.onError("websocket error",b)}},b}(e.default);b.default=g},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(1),g=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.readyState=f.default.CLOSED,b}return d(b,a),b.prototype.open=function(){this.doOpen()},b.prototype.close=function(){this.doClose()},b.prototype.send=function(a){this.write(a)},b.prototype.onError=function(a,b){var c=new Error(a);c.type="TransportError",c.description=b,this.emit("error",c)},b.prototype.onData=function(a){this.emit("packet",a)},b.prototype.onOpen=function(){this.readyState=f.default.OPEN,this.emit("open")},b.prototype.onClose=function(a){this.readyState=f.default.CLOSED,this.emit("close",a)},b}(e);b.default=g},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){this._status=a,this._reason=b}return Object.defineProperty(a.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"reason",{get:function(){return this._reason},enumerable:!0,configurable:!0}),a}();b.default=d},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(21),g=c(2),h=c(22),i=c(1),j=function(a){function b(b){var c=a.call(this)||this;return c.backoff=new f,c.autoConnect=!0,c.readyState=i.default.CLOSED,c.environment=b.environment,c.transport=c.environment.transports[0],c.keepAlive=new h.default(c.transport,b),c.listenNeworkStateChanges(),c.listen(),c}return d(b,a),b.prototype.connect=function(){this.readyState!==i.default.OPEN&&this.readyState!==i.default.OPENING&&(this.readyState=i.default.OPENING,this.autoConnect=!0,this.transport.open())},b.prototype.send=function(a){this.transport.send(a)},b.prototype.close=function(){this.autoConnect=!1,this._close()},b.prototype._close=function(){clearTimeout(this.reconnectAttemptTimeout),this.readyState!==i.default.CLOSED&&this.transport.close()},b.prototype.shouldReconnect=function(){return this.autoConnect&&this.environment.network.isOnline},b.prototype.reconnect=function(){var a=this,b=this.backoff.duration();this.reconnectAttemptTimeout=setTimeout(function(){return a.connect()},b)},b.prototype.listenNeworkStateChanges=function(){var a=this;this.environment.network.on("offline",function(){return a._close()}),this.environment.network.on("online",function(){return a.autoConnect&&a.connect()})},b.prototype.listen=function(){var a=this;g.default(this.transport,"open",function(){a.backoff.reset(),a.readyState=i.default.OPEN,a.keepAlive.schedule(),a.emit("open")}),g.default(this.transport,"close",function(b){a.readyState=i.default.CLOSED,a.shouldReconnect()&&a.reconnect(),a.dispose(),a.emit("close",b)}),g.default(this.transport,"packet",this.onPacket.bind(this))},b.prototype.onPacket=function(a){var b=JSON.parse(a);switch(b.type){case"message":case"ack":this.emit("message",b)}},b.prototype.dispose=function(){this.keepAlive.dispose()},b}(e);b.default=j},function(a,b){function c(a){a=a||{},this.ms=a.min||100,this.max=a.max||1e4,this.factor=a.factor||2,this.jitter=a.jitter>0&&a.jitter<=1?a.jitter:0,this.attempts=0}a.exports=c,c.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=0==(1&Math.floor(10*b))?a-c:a+c}return 0|Math.min(a,this.max)},c.prototype.reset=function(){this.attempts=0},c.prototype.setMin=function(a){this.ms=a},c.prototype.setMax=function(a){this.max=a},c.prototype.setJitter=function(a){this.jitter=a}},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(0),f=c(23),g=c(2),h=function(a){function b(b,c){var d=a.call(this)||this;return d.transport=b,d.opts=c,d.started=!1,g.default(d.transport,"packet",function(){return d.started&&d.schedule()}),d}return d(b,a),b.prototype.schedule=function(){var a=this;this.dispose(),this.started=!0,this.intervalTimer=new f.default(this.opts.pingInterval,function(){return a.sendHeartbeat()}),this.intervalTimer.schedule()},b.prototype.dispose=function(){this.started=!1,this.intervalTimer&&this.intervalTimer.cancel(),this.timeoutTimer&&this.timeoutTimer.cancel()},b.prototype.sendHeartbeat=function(){var a=this;this.ping(),this.timeoutTimer=new f.default(this.opts.pingTimeout,function(){return a.transport.close()}),this.timeoutTimer.schedule()},b.prototype.ping=function(){var a=JSON.stringify({type:"ping"});this.transport.send(a)},b}(e);b.default=h},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){this.timeout=a,this.handler=b}return a.prototype.schedule=function(){this.timer=setTimeout(this.handler,this.timeout)},a.prototype.cancel=function(){clearTimeout(this.timer)},a}();b.default=d},function(a,b,c){"use strict";function d(a,b,c,d){var e=JSON.stringify({target:a,invokeParams:b,instanceIds:c});d.target.postMessage(e,d.origin)}function e(){return Date.now()+"-"+Math.random()}var f=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var g=c(0),h=c(5),i=c(25),j=function(a){function b(b,c){var d=a.call(this)||this;return d.virtualSockets={},d.options={target:b,origin:c},d.listenCommands(),d}return f(b,a),b.prototype.connect=function(a){var b=e();this.managerCommand({method:"connect",params:[a]},{vsId:b});var c=new i.default(this,b);return this.virtualSockets[b]=c,c},b.prototype.vsCommand=function(a,b){return this.command(h.wsVs,a,b)},b.prototype.managerCommand=function(a,b){return this.command(h.wsClient,a,b)},b.prototype.command=function(a,b,c){return d(a,b,c,this.options)},b.prototype.listenCommands=function(){var a=this;window.addEventListener("message",function(b){var c=JSON.parse(b.data),d=c.target,e=c.invokeParams,f=c.instanceIds;if("wsDone"===d){var g=e.params,h=g.shift(),i=f.vsId,j=f.subId,k=a.virtualSockets[i];void 0!==j?(l=k.findChannel(j)).emit.apply(l,[h].concat(g)):k.emit.apply(k,[h].concat(g))}var l},!0)},b}(g);b.default=j},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),e=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a};Object.defineProperty(b,"__esModule",{value:!0});var f=c(4),g=c(26),h=function(a){function b(b,c){var d=a.call(this,g.default)||this;return d.io=b,d.vsId=c,d}return d(b,a),b.prototype.send=function(a,b){void 0===b&&(b={}),this.io.vsCommand(a,e({},b,{vsId:this.vsId}))},b.prototype.findChannel=function(a){return this.channels.find(a)},b}(f.default);b.default=h},function(a,b,c){"use strict";var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=c(3),f=function(a){function b(b,c){var d=a.call(this,c)||this;return d.io=b,d}return d(b,a),b.prototype.doSubscribe=function(){return this.io.send({method:"subscribe",params:[this.name]},{subId:this.name})},b.prototype.doUnsubscribe=function(){return this.io.send({method:"unsubscribe",params:[this.name]},{subId:this.name})},b}(e.default);b.default=f},function(a,b,c){"use strict";function d(a,b){return function(c){var d=JSON.stringify({target:"wsDone",invokeParams:c,instanceIds:b});(a.source||window).postMessage(d,a.origin||"*")}}Object.defineProperty(b,"__esModule",{value:!0});var e=c(5),f=function(){function a(a){this.duplexer=a,this.virtualSockets={}}return a.prototype.start=function(){var a=this;this.listener=function(b){var c=JSON.parse(b.data),f=c.target,g=c.invokeParams,h=c.instanceIds,i=d(b,h);f===e.wsClient?a._handleManager(g,h.vsId,i):f===e.wsVs&&a._handleVirtualSocket(g,h.vsId,i)},window.addEventListener("message",this.listener)},a.prototype.stop=function(){window.removeEventListener("message",this.listener),this.listener=void 0},a.prototype._handleManager=function(a,b,c){var d=this.duplexer[a.method],e=d.bind(this.duplexer);if("connect"===a.method){var f=e.apply(void 0,a.params);this.virtualSockets[b]=f,f.emit=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c({params:a})}}},a.prototype._handleVirtualSocket=function(a,b,c){var d=this.virtualSockets[b],e=d[a.method].bind(d),f=e.apply(void 0,a.params);"subscribe"===a.method&&(f.emit=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return c({params:a})})},a}();b.default=f},function(a,b){var c,d=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},e=Error;!function(a){function b(a,c){switch(typeof a){case"undefined":case"boolean":case"string":case"number":return a===c;case"object":if(null===a)return null===c;if(A(a)){if(!A(c)||a.length!==c.length)return!1;for(var d=0,e=a.length;e>d;d++)if(!b(a[d],c[d]))return!1;return!0}var f=t(c),g=f.length;if(t(a).length!==g)return!1;for(var d=0;g>d;d++)if(!b(a[d],c[d]))return!1;return!0;default:return!1}}function c(a){return-1===a.indexOf("/")&&-1===a.indexOf("~")?a:a.replace(/~/g,"~0").replace(/\//g,"~1")}function f(a){for(var b=0,c=x.length;c>b;b++)if(x[b].obj===a)return x[b]}function g(a,b){for(var c=0,d=a.observers.length;d>c;c++)if(a.observers[c].callback===b)return a.observers[c].observer}function h(a,b){for(var c=0,d=a.observers.length;d>c;c++)if(a.observers[c].observer===b)return void a.observers.splice(c,1)}function i(a,b){b.unobserve()}function j(a){return"object"==typeof a?JSON.parse(JSON.stringify(a)):a}function k(a,b){var c,d=[],i=f(a);if(i?c=g(i,b):(i=new y(a),x.push(i)),c)return c;if(c={},i.value=j(a),b){c.callback=b,c.next=null;var k=this.intervals||[100,1e3,1e4,6e4];if(void 0===k.push)throw new e("jsonpatch.intervals must be an array");var m=0,n=function(){l(c)},o=function(){clearTimeout(c.next),c.next=setTimeout(function(){n(),m=0,c.next=setTimeout(p,k[m++])},0)},p=function(){n(),m==k.length&&(m=k.length-1),c.next=setTimeout(p,k[m++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",o),window.addEventListener("mouseup",o),window.addEventListener("keydown",o)):(document.documentElement.attachEvent("onmousedown",o),document.documentElement.attachEvent("onmouseup",o),document.documentElement.attachEvent("onkeydown",o))),c.next=setTimeout(p,k[m++])}return c.patches=d,c.object=a,c.unobserve=function(){l(c),clearTimeout(c.next),h(i,c),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",o),window.removeEventListener("mouseup",o),window.removeEventListener("keydown",o)):(document.documentElement.detachEvent("onmousedown",o),document.documentElement.detachEvent("onmouseup",o),document.documentElement.detachEvent("onkeydown",o)))},i.observers.push(new z(b,c)),c}function l(a){for(var b,c=0,d=x.length;d>c;c++)if(x[c].obj===a.object){b=x[c];break}m(b.value,a.object,a.patches,""),a.patches.length&&o(b.value,a.patches);var e=a.patches;return e.length>0&&(a.patches=[],a.callback&&a.callback(e)),e}function m(a,b,d,e){for(var f=t(b),g=t(a),h=!1,i=g.length-1;i>=0;i--){var k=g[i],l=a[k];if(b.hasOwnProperty(k)){var n=b[k];"object"==typeof l&&null!=l&&"object"==typeof n&&null!=n?m(l,n,d,e+"/"+c(k)):l!=n&&(!0,d.push({op:"replace",path:e+"/"+c(k),value:j(n)}))}else d.push({op:"remove",path:e+"/"+c(k)}),h=!0}if(h||f.length!=g.length)for(var i=0;i<f.length;i++){var k=f[i];a.hasOwnProperty(k)||d.push({op:"add",path:e+"/"+c(k),value:j(b[k])})}}function n(a){for(var b,c=0,d=a.length;d>c;){if(!((b=a.charCodeAt(c))>=48&&57>=b))return!1;c++}return!0}function o(a,b,c){for(var d,e,f=!1,g=0,h=b.length;h>g;){d=b[g],g++;for(var i=d.path||"",j=i.split("/"),k=a,l=1,m=j.length,o=void 0;;){if(e=j[l],c&&void 0===o&&(void 0===k[e]?o=j.slice(0,l).join("/"):l==m-1&&(o=d.path),void 0!==o&&this.validator(d,g-1,a,o)),l++,void 0===e&&l>=m){f=w[d.op].call(d,k,e,a);break}if(A(k)){if("-"===e)e=k.length;else{if(c&&!n(e))throw new B("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",g-1,d.path,d);e=parseInt(e,10)}if(l>=m){if(c&&"add"===d.op&&e>k.length)throw new B("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",g-1,d.path,d);f=v[d.op].call(d,k,e,a);break}}else if(e&&-1!=e.indexOf("~")&&(e=e.replace(/~1/g,"/").replace(/~0/g,"~")),l>=m){f=u[d.op].call(d,k,e,a);break}k=k[e]}}return f}function p(a,b){var c=[];return m(a,b,c,""),c}function q(a){if(void 0===a)return!0;if("array"==typeof a||"object"==typeof a)for(var b in a)if(q(a[b]))return!0;return!1}function r(b,c,d,e){if("object"!=typeof b||null===b||A(b))throw new B("Operation is not an object","OPERATION_NOT_AN_OBJECT",c,b,d);if(!u[b.op])throw new B("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",c,b,d);if("string"!=typeof b.path)throw new B("Operation `path` property is not a string","OPERATION_PATH_INVALID",c,b,d);if(("move"===b.op||"copy"===b.op)&&"string"!=typeof b.from)throw new B("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",c,b,d);if(("add"===b.op||"replace"===b.op||"test"===b.op)&&void 0===b.value)throw new B("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",c,b,d);if(("add"===b.op||"replace"===b.op||"test"===b.op)&&q(b.value))throw new B("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",c,b,d);if(d)if("add"==b.op){var f=b.path.split("/").length,g=e.split("/").length;if(f!==g+1&&f!==g)throw new B("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",c,b,d)}else if("replace"===b.op||"remove"===b.op||"_get"===b.op){if(b.path!==e)throw new B("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",c,b,d)}else if("move"===b.op||"copy"===b.op){var h={op:"_get",path:b.from,value:void 0},i=a.validate([h],d);if(i&&"OPERATION_PATH_UNRESOLVABLE"===i.name)throw new B("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",c,b,d)}}function s(a,b){try{if(!A(a))throw new B("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(b)b=JSON.parse(JSON.stringify(b)),o.call(this,b,a,!0);else for(var c=0;c<a.length;c++)this.validator(a[c],c)}catch(a){if(a instanceof B)return a;throw a}}var t=function(a){if(A(a)){for(var b=new Array(a.length),c=0;c<b.length;c++)b[c]=""+c;return b}if(Object.keys)return Object.keys(a);var b=[];for(var d in a)a.hasOwnProperty(d)&&b.push(d);return b},u={add:function(a,b){return a[b]=this.value,!0},remove:function(a,b){return delete a[b],!0},replace:function(a,b){return a[b]=this.value,!0},move:function(a,b,c){var d={op:"_get",path:this.from};return o(c,[d]),o(c,[{op:"remove",path:this.from}]),o(c,[{op:"add",path:this.path,value:d.value}]),!0},copy:function(a,b,c){var d={op:"_get",path:this.from};return o(c,[d]),o(c,[{op:"add",path:this.path,value:d.value}]),!0},test:function(a,c){return b(a[c],this.value)},_get:function(a,b){this.value=a[b]}},v={add:function(a,b){return a.splice(b,0,this.value),!0},remove:function(a,b){return a.splice(b,1),!0},replace:function(a,b){return a[b]=this.value,!0},move:u.move,copy:u.copy,test:u.test,_get:u._get},w={add:function(a){w.remove.call(this,a);for(var b in this.value)this.value.hasOwnProperty(b)&&(a[b]=this.value[b]);return!0},remove:function(a){for(var b in a)a.hasOwnProperty(b)&&u.remove.call(this,a,b);return!0},
replace:function(a){return o(a,[{op:"remove",path:this.path}]),o(a,[{op:"add",path:this.path,value:this.value}]),!0},move:u.move,copy:u.copy,test:function(a){return JSON.stringify(a)===JSON.stringify(this.value)},_get:function(a){this.value=a}},x=[],y=function(){function a(a){this.observers=[],this.obj=a}return a}(),z=function(){function a(a,b){this.callback=a,this.observer=b}return a}();a.unobserve=i,a.observe=k,a.generate=l;var A;A=Array.isArray?Array.isArray:function(a){return a.push&&"number"==typeof a.length},a.apply=o,a.compare=p;var B=function(a){function b(b,c,d,e,f){a.call(this,b),this.message=b,this.name=c,this.index=d,this.operation=e,this.tree=f}return d(b,a),b}(e);a.JsonPatchError=B,a.Error=B,a.validator=r,a.validate=s}(c||(c={})),void 0!==b&&(b.apply=c.apply,b.observe=c.observe,b.unobserve=c.unobserve,b.generate=c.generate,b.compare=c.compare,b.validate=c.validate,b.validator=c.validator,b.JsonPatchError=c.JsonPatchError,b.Error=c.Error)},function(a,b){angular.module("onboardingServerJsApiAppInternal",["wixAngular","wix.common.bi"]),angular.module("onboardingServerJsApiApp",["onboardingServerJsApiAppInternal"]).config(function(){})},function(a,b,c){"use strict"},function(a,b,c){"use strict"},function(a,b,c){"use strict"},function(a,b,c){"use strict"},function(a,b,c){"use strict"},function(a,b,c){"use strict"},function(a,b,c){"use strict"},function(a,b,c){"use strict"},function(a,b,c){"use strict"},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a){this.$q=a,this.errorCodesCallbackMap={},this.editorSessionId=null}return a.$inject=["$q"],a.prototype.setEditorSessionId=function(a){this.editorSessionId=a},a.prototype.getEditorSessionId=function(){return this.editorSessionId},a.prototype.onSessionExpired=function(a){this.sessionExpired=a,this.setErrorCodeCallback([-12,-15,-16],this.sessionExpired)},a.prototype.onConflictingChanges=function(a){this.conflictingChanges=a,this.setErrorCodeCallback([-26e3],this.conflictingChanges)},a.prototype.onSiteNotManagedByOB=function(a){this.siteNotManagedByOB=a,this.setErrorCodeCallback([-26009],this.siteNotManagedByOB)},a.prototype.onStoryArchived=function(a){this.storyArchived=a,this.setErrorCodeCallback([-26002],this.storyArchived)},a.prototype.getResponse=function(a){var b=this;return void 0===a&&(a=!1),function(c){if(b.isErrorResponse(c)){var d=b.errorCodesCallbackMap[c.data.errorCode];return d&&d(c),b.$q.reject(c)}return a?b.$q.reject(c):c.data}},a.prototype.isErrorResponse=function(a){return a.data&&a.data.errorCode},a.prototype.setErrorCodeCallback=function(a,b){var c=this;a.forEach(function(a){return c.errorCodesCallbackMap[a]=b})},a}();a.JsApiManager=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("jsApiManager",d.JsApiManager)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b,c){this.$http=a,this.$q=b,this.jsApiManager=c,this.endpointPrefix="/_api/onboarding-server-web/content/"}return a.$inject=["$http","$q","jsApiManager"],a.prototype.setPayload=function(a){return this.$http.post(this.endpointPrefix+"index",a).then(function(){})},a.prototype.suggest=function(a){if(!a)return this.$q.when([]);var b=this.endpointPrefix+"suggestCategory?q="+encodeURIComponent(this.sanitize(a));this.contentVersionId&&(b+="&indexVersion="+this.contentVersionId);var c=this.jsApiManager.getEditorSessionId();return c&&(b+="&editorSessionId="+c),this.locale&&(b+="&locale="+this.locale),this.$http.get(b).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0)).then(function(a){return a.results})},a.prototype.elasticSearch=function(a,b,c,d){if(void 0===d&&(d=!1),!a)return this.$q.when(null);var e;e=d?this.endpointPrefix+"suggestCategory2?q="+encodeURIComponent(a):this.endpointPrefix+"suggestCategory2?q="+encodeURIComponent(this.sanitize(a)),this.contentVersionId&&(e+="&indexVersion="+this.contentVersionId);var f=this.jsApiManager.getEditorSessionId();return f&&(e+="&editorSessionId="+f),this.locale&&(e+="&locale="+this.locale),b&&(e+="&limit="+b),c&&(e+="&relatedLimit="+c),this.$http.get(e).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.load=function(a){var b=this.endpointPrefix+"lookup",c=[];return(a.industryId||a.structureId)&&(a.industryId&&c.push("industryId="+a.industryId),a.structureId&&c.push("structureId="+a.structureId),this.contentVersionId&&c.push("indexVersion="+this.contentVersionId),this.locale&&c.push("locale="+this.locale),b+="?"+c.join("&")),this.$http.get(b).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.setContentVersionId=function(a){this.contentVersionId=a},a.prototype.setLocale=function(a){this.locale=a},a.prototype.sanitize=function(a){return a.replace(/[^0-9a-z\s\-+\/.;()'&]/gi,"")},a}();a.CmsApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("cmsApi",d.CmsApi)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b){this.$http=a,this.jsApiManager=b,this.endpointPrefix="/_api/onboarding-server-web/site"}return a.$inject=["$http","jsApiManager"],a.prototype.create=function(a,b){var c={templateMetaSiteId:a};return b&&(c.siteName=b),this.$http.post(this.endpointPrefix,c).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a}();a.SiteApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("siteApi",d.SiteApi)},function(a,b,c){"use strict";var d=window.Duplexer;e=window.ob;var e;!function(a){!function(a){a[a.Fail=0]="Fail",a[a.InProgress=1]="InProgress",a[a.Done=2]="Done"}(a.SiteConverterStatus||(a.SiteConverterStatus={}));!function(a){a[a.BadUrl=0]="BadUrl",a[a.HTTP40X=1]="HTTP40X",a[a.HTTP50X=2]="HTTP50X",a[a.BadData=3]="BadData",a[a.ServerError=4]="ServerError",a[a.Timeout=5]="Timeout"}(a.FailReason||(a.FailReason={}));var b=function(){function a(a,b){this.url=a,this.title=b}return a}();a.SiteInfoRequest=b;var c=function(){function a(){}return a}();a.SiteValidationResponse=c;var e=function(){function a(){}return a}();a.SiteInfoResponse=e;var f=function(){function a(){}return a}();a.FullSiteDataResponse=f;var g=function(){function a(){this.logo=""}return a}();a.GeneralInfo=g;var h=function(){function a(){}return a}();a.SocialLinkData=h;var i=function(){function a(){}return a}();a.ImageItem=i;var j=function(){function a(){this.address="",this.phone="",this.email=""}return a}();a.ContactDetails=j;var k=function(){function a(){this.contactDetails=new j,this.generalInfo=new g}return a}();a.BusinessInfoResponse=k;var l=function(){function a(a,b,c,d){this.$http=a,this.$q=b,this.$window=c,this.jsApiManager=d,this.duplexerSocketServer="wss://apps.wix.com/wix-duplexer-sockets-server",this.endpointPrefix="/_api/adi-import-site-server-webapp/site",this.siteInfoUrl="info",this.validationUrl="validate",this.businessInfoUrl="businessInfo",this.analyzeTaskUrl="analyzeTask",this.apiKey="adi",this.userIdCookieName="_wixUIDX",this.eventName="AnalyzeSiteResultMessage"}return a.$inject=["$http","$q","$window","jsApiManager"],a.prototype.initDuplexer=function(){var a=new d(this.duplexerSocketServer);this.duplexerApp=a.connect({apiKey:this.apiKey})},a.prototype.readCookie=function(a){var b=this.$window.document.cookie.split("; ").find(function(b){return 0===b.indexOf(a+"=")});return b?b.replace(/.*=/g,""):null},a.prototype.getSiteInfo=function(a){return this.$http.get(this.endpointPrefix+"/"+this.siteInfoUrl+"?url="+a.url).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.getSiteValidation=function(a){return this.$http.get(this.endpointPrefix+"/"+this.validationUrl+"?url="+a.url).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.analyzeTask=function(a){this.$http.post(this.endpointPrefix+"/"+this.analyzeTaskUrl+"?url="+a.url+"&siteTitle="+a.title,{})},a.prototype.getBusinessInfo=function(a){return this.$http.get(this.endpointPrefix+"/"+this.businessInfoUrl+"?url="+a.url+"&siteTitle="+a.title).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.getFullSiteData=function(a){var b=this,c=a;return new Promise(function(d,e){b.initDuplexer(),b.duplexerApp.on("@duplexer:connected",function(){var f=b.getUserId();if(f){var g=f,h=b.duplexerApp.subscribe(g);b.analyzeTask(a),h.on(b.eventName,function(a){b.duplexerApp.unsubscribe(g),b.duplexerApp.disconnect(),a.url===c.url&&d(a)})}else e()})})},a.prototype.getUserId=function(){var a=this.readCookie(this.userIdCookieName);return a&&a.split("|")[1]},a}();a.SiteDataRetrivalApi=l,angular.module("onboardingServerJsApiAppInternal").service("siteDataRetrivalApi",l)}(e||(e={}))},function(a,b,c){"use strict";jsonpatch=window.jsonpatch;var d;!function(a){var b=function(){function a(a,b,c){this.$http=a,this.jsApiManager=b,this.cacheKillerParam=c,this.endpointPrefix="/_api/onboarding-server-web/story"}return a.$inject=["$http","jsApiManager","cacheKillerParam"],a.prototype.create2=function(a){return this.$http.post(this.decorateEndpoint(this.endpointPrefix,"new"),a).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.create=function(a){return this.$http.post(this.decorateEndpoint(this.buildEndpoint()),'"'+a+'"').then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.get=function(a,b){void 0===b&&(b=null);var c=this.decorateEndpoint(this.buildEndpoint(a,b));return this.$http.get(c,null).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.getRevisions=function(a,b,c){void 0===b&&(b=1),void 0===c&&(c=100);var d=this.decorateEndpoint(this.buildEndpoint(a),"revisions",["from="+b,"limit="+c]);return this.$http.get(d,null).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.getMajorRevisions=function(a){var b=this.decorateEndpoint(this.buildEndpoint(a),"revisions/major");return this.$http.get(b,null).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.metadata=function(a){var b=this.decorateEndpoint(this.buildEndpoint(a),"metadata");return this.$http.get(b,null).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.update=function(a,b,c,d,e){void 0===e&&(e=null);var f=jsonpatch.compare(c,d),g={diff:f,action:"update"};e&&(g.htmlRevision=e);var h=this.decorateEndpoint(this.buildEndpoint(a,b));return this.$http.put(h,g).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.rollback=function(a,b){var c={targetRevision:b,action:"rollback"},d=this.decorateEndpoint(this.buildEndpoint(a));return this.$http.put(d,c).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.publish=function(a){var b={action:"publish"},c=this.decorateEndpoint(this.buildEndpoint(a));return this.$http.put(c,b).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.markAsMajorRevision=function(a){var b={action:"markAsMajor"},c=this.decorateEndpoint(this.buildEndpoint(a));return this.$http.put(c,b).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.markCreated=function(a,b,c){var d={templateMetaSiteId:b,metaSiteId:a.metaSiteId,siteId:c},e=this.decorateEndpoint(this.buildEndpoint(a),"markCreated");return this.$http.put(e,d).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.archive=function(a){var b=this.decorateEndpoint(this.buildEndpoint(a)),c={action:"archive"};return this.$http.put(b,c).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.buildEndpoint=function(a,b){void 0===a&&(a=null),void 0===b&&(b=null);var c=this.endpointPrefix;return null!==a&&(c+="/"+a.instanceId+":"+a.metaSiteId),null!==b&&(c+="/"+b),c},a.prototype.decorateEndpoint=function(a,b,c){void 0===b&&(b=null),void 0===c&&(c=[]);var d=["cacheKiller="+this.cacheKillerParam()].concat(c),e=this.jsApiManager.getEditorSessionId();return e&&d.push("editorSessionId="+e),a+(b?"/"+b:"")+"?"+d.join("&")},a}();a.StoryApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("storyApi",d.StoryApi).factory("cacheKillerParam",function(){return function(){return Date.now().toString()}})},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b,c){var d=this;this.$q=a,this.storyApi=b,this.siteApi=c,this.create=function(a){return d.enqueue(function(){return d.createStory(a)})},this.create2=function(a){return d.enqueue(function(){return d.createStory2(a)})},this.createSiteFromTemplate=function(a,b){return d.enqueue(function(){return d.siteApi.create(a,b)})},this.get=function(a,b){return d.enqueue(function(){return d.getStory(a,b)})},this.update=function(a){return d.enqueue(function(){return d.updateStory(a)})},this.publish=function(a){return d.enqueue(function(){return d.publishStory(a)})},this.markAsMajorRevision=function(a){return d.enqueue(function(){return d.markStoryAsMajorRevision(a)})},this.markCreated=function(a,b,c){return d.enqueue(function(){return d._markCreated(a,b,c)})}}return a.$inject=["$q","storyApi","siteApi"],a.prototype.enqueue=function(a){return this.lastAction?(this.lastAction=this.lastAction.then(a,a),this.lastAction):(this.lastAction=a(),this.lastAction)},a.prototype.preload=function(a,b){return b.storyId=a,this.currentStory=this.cloneStory(b),b},a.prototype.createStory=function(a){var b=this;return this.storyApi.create(a).then(function(c){var d={storyId:{instanceId:c.instanceId,metaSiteId:a},revision:c.revision,blob:{}};return b.currentStory=b.cloneStory(d),d})},a.prototype.createStory2=function(a){var b=this;return this.storyApi.create2(a).then(function(a){var c={storyId:{instanceId:a.instanceId,metaSiteId:a.metaSiteId},siteId:a.siteId,revision:a.revision,blob:{}};return b.currentStory=b.cloneStory(c),c})},a.prototype.getStory=function(a,b){var c=this;return this.storyApi.get(a,b).then(function(d){return _.isNumber(b)?(d.storyId=a,d):c.preload(a,d)})},a.prototype.updateStory=function(a,b){var c=this;if(void 0===b&&(b=!0),a.storyId.instanceId!==this.currentStory.storyId.instanceId||a.storyId.metaSiteId!==this.currentStory.storyId.metaSiteId)return this.$q.reject("storyId "+a.storyId.instanceId+":"+a.storyId.metaSiteId+" does not match "+this.currentStory.storyId.instanceId+":"+this.currentStory.storyId.metaSiteId);var d=angular.copy(a.blob);return this.storyApi.update(a.storyId,this.currentStory.revision,this.currentStory.blob,d,a.htmlRevision).then(function(a){return c.updateCurrentBlob(d),c.currentStory.revision=a,c.cloneStory(c.currentStory)}).catch(function(d){return b&&c.isDataCorruptionError(d)?c.handleDataCorruptionError(a):c.$q.reject(d)})},a.prototype.publishStory=function(a){var b=this;return this.storyApi.publish(a.storyId).then(function(a){return b.currentStory.revision=a,a})},a.prototype.markStoryAsMajorRevision=function(a){var b=this;return this.storyApi.markAsMajorRevision(a.storyId).then(function(a){return b.currentStory.revision=a,a})},a.prototype._markCreated=function(a,b,c){return this.storyApi.markCreated(a.storyId,b,c)},a.prototype.isDataCorruptionError=function(b){return b.status===a.DATA_CORRUPTION_STATUS&&b.data&&b.data.errorCode===a.DATA_CORRUPTION_ERROR_CODE},a.prototype.handleDataCorruptionError=function(a){var b=this;return this.getStory(a.storyId).then(function(){return b.updateStory(a,!1)})},a.prototype.cloneStory=function(a){return angular.copy(a)},a.prototype.updateCurrentBlob=function(a){this.currentStory.blob=a},a.DATA_CORRUPTION_STATUS=400,a.DATA_CORRUPTION_ERROR_CODE=-26011,a}();a.StoryManager=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("storyManager",d.StoryManager)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b){this.$http=a,this.jsApiManager=b,this.endpointPrefix="/_api/onboarding-server-web/location"}return a.$inject=["$http","jsApiManager"],a.prototype.getGeoLocation=function(){return this.$http.get(this.endpointPrefix).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a}();a.LocationApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("locationApi",d.LocationApi)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b){this.$http=a,this.jsApiManager=b,this.endpointPrefix="/_api/onboarding-server-web/sitename"}return a.$inject=["$http","jsApiManager"],a.prototype.getUniqueName=function(a){if(!a||!a.length)throw"empty site name";var b=this.endpointPrefix+"?suggestedName="+encodeURIComponent(a),c={headers:{Accept:"text/plain"}};return this.$http.get(b,c).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.rename=function(a,b){if(!b)throw"empty name";var c=this.endpointPrefix+"/"+a+"/rename?newName="+encodeURIComponent(b);return this.$http.post(c,null).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a}();a.SiteNameApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("siteNameApi",d.SiteNameApi)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b){this.$http=a,this.jsApiManager=b,this.endpointPrefix="/_api/onboarding-server-web/metasite",this.countryCodesByName={"united states":"US",france:"FR"}}return a.$inject=["$http","jsApiManager"],a.prototype.setSiteProperties=function(a,b){var c=this.prepareRequest(b);return this.$http.put(this.endpointPrefix+"/"+a+"/properties",c).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0)).then(function(){})},a.prototype.getSiteProperties=function(a){return this.$http.get(this.endpointPrefix+"/"+a+"/properties").then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.prepareRequest=function(a){var b={};if(!a.name)throw new Error("name must be set when updating site properties");b.businessName={value:a.name},a.categories&&a.categories.primary&&a.categories.secondary&&(b.categories={primary:a.categories.primary,secondary:a.categories.secondary}),a.email&&(b.email={address:a.email}),a.phone&&(b.phone={number:a.phone}),a.fax&&(b.fax={number:a.fax}),a.logo&&(b.logo={url:a.logo});var c=a.address&&a.address.country?this.getCountryCode(a.address.country):null;return a.address&&a.address.street&&a.address.city&&a.address.country&&c&&(b.postalAddress={street:a.address.street,city:a.address.city,country:c},a.address.state&&(b.postalAddress.state=a.address.state),a.address.zip&&(b.postalAddress.zip=a.address.zip)),a.address&&(b.postalAddress=b.postalAddress||{},a.address.fullAddress&&(b.postalAddress.fullAddress=a.address.fullAddress),a.address.googleFormattedAddress&&(b.postalAddress.googleFormattedAddress=a.address.googleFormattedAddress)),b},a.prototype.getCountryCode=function(a){return a=(a||"").toLowerCase(),a.length>3&&(a=this.countryCodesByName[a]),a?a.toUpperCase():""},a}();a.MetaSiteApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("metaSiteApi",d.MetaSiteApi)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b){this.$http=a,this.jsApiManager=b,this.endpointPrefix="/_api/onboarding-server-web/media"}return a.$inject=["$http","jsApiManager"],a.prototype.upload=function(a){var b={albumsToUpload:_.map(a,function(a){return{albumName:a.name,mediaUrls:a.urls}})};return this.$http.post(this.endpointPrefix+this.calcESISuffix(),b).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a.prototype.calcESISuffix=function(){var a=this.jsApiManager.getEditorSessionId();return a?"?editorSessionId="+a:""},a}();a.MediaApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("mediaApi",d.MediaApi)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b){this.$http=a,this.jsApiManager=b,this.endpointPrefix="/_api/wix-dealer-integration-webapp/salesSystemResolver"}return a.$inject=["$http","jsApiManager"],a.prototype.getCampaign=function(a){return this.$http.get(this.endpointPrefix+"?siteGuid="+a).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a}();a.DealerApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("dealerApi",d.DealerApi)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b){this.$http=a,this.jsApiManager=b,this.endpointPrefix="/_api/wix-html-login-webapp/user/getUserDetails"}return a.$inject=["$http","jsApiManager"],a.prototype.getUserDetails=function(){return this.$http.get(this.endpointPrefix).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a}();a.UserDetailsApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("userDetailsApi",d.UserDetailsApi)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b){this.$http=a,this.jsApiManager=b,this.endpointPrefix="/_api/onboarding-custom-pallete-server-webapp/coloring/colorMatches"}return a.$inject=["$http","jsApiManager"],a.prototype.getMatches=function(a,b,c){var d=this.buildUrl(a,b,c);return this.$http.get(d).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0)).then(function(a){return{matches:a.matches.map(function(a){return a.startsWith("#")?a:"#"+a})}})},a.prototype.buildUrl=function(a,b,c){a.startsWith("#")&&(a=a.substr(1));var d=this.endpointPrefix+"?color="+a;return b&&(d+="&limit="+b),c&&(d+="&nearestNeighbours="+c),d},a}();a.ColorApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("colorApi",d.ColorApi)},function(a,b,c){"use strict";var d;!function(a){var b=function(){function a(a,b,c){this.$http=a,this.$q=b,this.jsApiManager=c,this.endpointPrefix="/_api/adi-node-renderer/"}return a.$inject=["$http","$q","jsApiManager"],a.prototype.sanitize=function(a){return a.replace(/[^0-9a-z\s\-+\/.;()'&]/gi,"")},a.prototype.createAndRender=function(a,b,c,d){var e=this.endpointPrefix+"create_render?";return e=e+"industryId="+encodeURIComponent(this.sanitize(b)),e=e+"&structureId="+encodeURIComponent(this.sanitize(a)),e=e+"&businessName="+encodeURIComponent(this.sanitize(c)),e=e+"&flags="+encodeURIComponent(d?this.sanitize(d):"noTour&silentBI&noSpinners"),this.$http.post(e,"").then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0)).then(function(a){return a.id})},a.prototype.renderHomePage=function(a,b){var c=this.endpointPrefix+"render_home_page/"+a;return b&&(c=c+"?flags="+encodeURIComponent(this.sanitize(b))),this.$http.post(c,"").then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0)).then(function(a){return a.id})},a.prototype.renderAlternateHomePages=function(a,b,c){throw"not implemented"},a.prototype.getTaskStatus=function(a){var b=this.endpointPrefix+"status/"+a;return this.$http.get(b).then(this.jsApiManager.getResponse(!1),this.jsApiManager.getResponse(!0))},a}();a.ServerSideRenderApi=b}(d||(d={})),angular.module("onboardingServerJsApiAppInternal").service("serverSideRenderApi",d.ServerSideRenderApi)}]);
//# sourceMappingURL=npm-js-api.min.js.map